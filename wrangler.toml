# Cloudflare Pages設定ファイル
name = "we-diet-frontend"
compatibility_date = "2024-01-01"

[build]
command = "npm run build"
cwd = ""

[build.upload]
# ビルド成果物をアップロード
format = "modules"
dir = "build"
main = "index.html"

[[build.upload.rules]]
# 静的ファイルの処理ルール
type = "ESModule"
globs = ["**/*.js"]

[[build.upload.rules]]
# CSSファイルの処理ルール
type = "Text"
globs = ["**/*.css"]

[[build.upload.rules]]
# 画像ファイルの処理ルール
type = "Data"
globs = ["**/*.{png,jpg,jpeg,gif,svg,ico,webp}"]

# 環境変数設定
[env.production]
VITE_API_BASE_URL = "https://we-diet-backend.com"

[env.preview]
VITE_API_BASE_URL = "https://we-diet-backend.com"

# Pages設定
[pages]
# SPAルーティングのためのリダイレクト設定
routes = [
  # APIルートはプロキシしない
  { pattern = "/api/*", zone_name = "", custom_domain = false },
  # その他はすべてSPAとして処理
  { pattern = "/*", zone_name = "", custom_domain = false }
]

# 関数の設定（必要に応じて）
[functions]
# デフォルトで無効
enabled = false
